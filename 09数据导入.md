## Fastq格式

Fastq格式是一种基于文本的存储生物序列和对应碱基（或氨基酸）质量的文件格式。最初由桑格研究所（Wellcome Trust Sanger Institute）开发出来，现已成为存储高通量测序数据的事实标准。

![image](https://raw.githubusercontent.com/lpz1999/qiime2/main/image/fastq%E7%A4%BA%E4%BE%8B.png)

@SIM:1:FCX:1:15:6329:1045:GATTACT+GTCTTAAC 1:N:0:ATCCGA
TCGCACTCAACGCCCTGCATATGACAAGACAGAATC
+
<>;##=><9=AAAAAAAAAA9#:<#<;<<<????#

每条fastq记录代表一条reads的序列信息，包含四行字符：
第一行：必须以@开头，后面跟着序列的唯一ID以及相关说明内容。
@<instrument>:<run number>:<flowcell ID>:<lane>:<tile>:<x-pos>:<y-pos>:<UMI> <read>:<is filtered>:<control number>:<index>

@SIM，测序仪的ID号
1，run number，一张flowcell是一个run
FCX，flow cell的ID号
1，lane号
15，tile号（tile为flow cell上最小单位，测序时每测一个碱基，照相一次）
6329，flow cell中簇位置的X坐标
1045，flow cell中簇位置的Y坐标
GATTACT+GTCTTAAC 1，当sampleSheet存在UMI(Unique Molecular indentifier，用于提高测序的准确性)时该项存在；为Read1的UMI序列+Read2的UMI序列信息，下图为文库中UMI的位置
1，1 表示 single read 2 表示 paired end
N，是否过滤，Y表示被过滤，否则为N
0，偶数，没有控制位时为0
ATCCGA，index序列

第二行：核酸序列，Sequence，是有ATCGN字符组成。
   
第三行：“ ”开头，内容和第一行@后面的一样。Quality score identifier line (consisting only of a +)
以“+”开头，为节省存储空间什么也不加，以前会重复第一行信息

第四行： Quality score，测序质量值，描述第二列中每个碱基的可靠程度，用ASCII码表示
碱基质量得分与错误率的换算关系： Q = -10log10p（p表示测序的错误率，与测序时，荧光纯度相关Q表示碱基质量分数）；Q20代表准确度99%，Q30代表准确度99.9%，类推
质量值=ASCII码-33/64,（不同的标准，由于ASCII码前32位为空字符，64位之后是英文字母）
![image](https://raw.githubusercontent.com/lpz1999/qiime2/main/image/ASCII%E7%A0%81.png)


## 导入带质量值的FASTQ测序数据
**Sequence data with sequence quality information (i.e. FASTQ)**

使用QIIME 2，可以导入不同类型的fastq数据：
- 采用地球微生物组计划(EMP)标准方法产生的FASTQ格式数据
- CASAVA 1.8多样本混合格式的FASTQ数据
- 任何其他类型的fastq数据

### EMP标准混样单端数据
**“EMP protocol” multiplexed single-end fastq**

此类数据标准包括两个文件，扩展名均为`fastq.gz`，
1. 一个是barcode文件，
2. 另一个是样品混样测序数据文件。

此部分的数据己经在[《4人体各部位微生物组分析》](https://mp.weixin.qq.com/s/Stlb1ri6W7aSOF2rX2ru1A)中下载过，可直接链接过来，或使用如下命令下载

```
# 建样品目录
mkdir -p emp-single-end-sequences
# 方法1. 链接之前第4节中的文件
ln ../moving-pictures/emp-single-end-sequences/*.gz emp-single-end-sequences/
# 方法2. 从头下载
# 下载 barcode文件
wget -c \
  -O "emp-single-end-sequences/barcodes.fastq.gz" \
  "https://data.qiime2.org/2019.7/tutorials/moving-pictures/emp-single-end-sequences/barcodes.fastq.gz"
# 下载序列文件
wget -c \
  -O "emp-single-end-sequences/sequences.fastq.gz" \
  "https://data.qiime2.org/2019.7/tutorials/moving-pictures/emp-single-end-sequences/sequences.fastq.gz"
```

导入EMP单端测序文件命令格式

```
# 25M，8s
time qiime tools import \
  --type EMPSingleEndSequences \
  --input-path emp-single-end-sequences \
  --output-path emp-single-end-sequences.qza
```

输出对象：

- `emp-single-end-sequences.qza`：导入的EMP单端序列。 [查看](https://view.qiime2.org/?src=https%3A%2F%2Fdocs.qiime2.org%2F2020.11%2Fdata%2Ftutorials%2Fimporting%2Femp-single-end-sequences.qza) | [下载](https://docs.qiime2.org/2020.11/data/tutorials/importing/emp-single-end-sequences.qza)
